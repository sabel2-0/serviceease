<aside class="bg-slate-900 text-white w-64 min-h-screen shadow-lg border-r border-slate-700 flex flex-col">
    <!-- Header -->
    <div class="p-6 border-b border-slate-700 flex-shrink-0">
        <div class="flex items-center space-x-3">
            <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
                <i class="fas fa-cogs text-white"></i>
            </div>
            <div>
                <h1 class="text-xl font-bold text-white">ServiceEase</h1>
                <p class="text-sm text-slate-400">Admin Portal</p>
            </div>
        </div>
    </div>
    
    <!-- Navigation Content -->
    <div class="flex-1 overflow-y-auto">
        <nav class="p-4 space-y-2">
        <!-- Dashboard -->
        <a href="admin.html" class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="admin">
            <i class="fas fa-tachometer-alt w-5 h-5 mr-3"></i>
            <span>Dashboard</span>
        </a>

        <!-- User Management Dropdown -->
        <div class="dropdown" data-dropdown="user-management">
            <button class="dropdown-toggle group flex items-center justify-between w-full px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-white rounded-lg transition-colors">
                <div class="flex items-center">
                    <i class="fas fa-users-cog w-5 h-5 mr-3"></i>
                    <span>User Management</span>
                </div>
                <i class="fas fa-chevron-down transition-transform duration-200"></i>
            </button>
            <div class="dropdown-content hidden pl-6 mt-2 space-y-1 border-l-2 border-slate-700 ml-8">
                <a href="staff-accounts.html" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="staff-accounts">
                    <i class="fas fa-users w-4 h-4 mr-3"></i>
                    <span class="text-sm">Staff Accounts</span>
                </a>
                <a href="Institution Admin-management.html" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="Institution Admin-management">
                    <i class="fas fa-user-tie w-4 h-4 mr-3"></i>
                    <span class="text-sm">Institution Admin Accounts</span>
                </a>
                <a href="Institution Admin-approvals.html" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="Institution Admin-approvals">
                    <i class="fas fa-user-check w-4 h-4 mr-3"></i>
                    <span class="text-sm">Institution Admin Registrations</span>
                </a>
            </div>
        </div>

        <!-- Client & Inventory Dropdown -->
        <div class="dropdown" data-dropdown="client-inventory">
            <button class="dropdown-toggle group flex items-center justify-between w-full px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-white rounded-lg transition-colors">
                <div class="flex items-center">
                    <i class="fas fa-building w-5 h-5 mr-3"></i>
                    <span>Clients & Inventory</span>
                </div>
                <i class="fas fa-chevron-down transition-transform duration-200"></i>
            </button>
            <div class="dropdown-content hidden pl-6 mt-2 space-y-1 border-l-2 border-slate-700 ml-8">
                <a href="client-management.html" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="client-management">
                    <i class="fas fa-building w-4 h-4 mr-3"></i>
                    <span class="text-sm">Client Management</span>
                </a>
                <a href="client-printers.html" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="client-printers">
                    <i class="fas fa-print w-4 h-4 mr-3"></i>
                    <span class="text-sm">Client Printers</span>
                </a>
                <a href="inventory-items.html" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="inventory-printers">
                    <i class="fas fa-print w-4 h-4 mr-3"></i>
                    <span class="text-sm">Printers</span>
                </a>
                <a href="inventory-parts.html" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="inventory-parts">
                    <i class="fas fa-puzzle-piece w-4 h-4 mr-3"></i>
                    <span class="text-sm">Printer Parts</span>
                </a>
            </div>
        </div>

        <!-- Service Management Dropdown -->
        <div class="dropdown" data-dropdown="service-management">
            <button class="dropdown-toggle group flex items-center justify-between w-full px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-white rounded-lg transition-colors">
                <div class="flex items-center">
                    <i class="fas fa-clipboard-list w-5 h-5 mr-3"></i>
                    <span>Service Management</span>
                </div>
                <i class="fas fa-chevron-down transition-transform duration-200"></i>
            </button>
            <div class="dropdown-content hidden pl-6 mt-2 space-y-1 border-l-2 border-slate-700 ml-8">
                <a href="#" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="parts-requests">
                    <i class="fas fa-tools w-4 h-4 mr-3"></i>
                    <span class="text-sm">Parts Requests</span>
                </a>
                <a href="#" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="service-requests">
                    <i class="fas fa-clipboard-list w-4 h-4 mr-3"></i>
                    <span class="text-sm">Service Requests</span>
                </a>
                <a href="#" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="service-history">
                    <i class="fas fa-history w-4 h-4 mr-3"></i>
                    <span class="text-sm">Service History</span>
                </a>
            </div>
        </div>

        <!-- System & Settings Dropdown -->
        <div class="dropdown" data-dropdown="system-settings">
            <button class="dropdown-toggle group flex items-center justify-between w-full px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-white rounded-lg transition-colors">
                <div class="flex items-center">
                    <i class="fas fa-cog w-5 h-5 mr-3"></i>
                    <span>System & Settings</span>
                </div>
                <i class="fas fa-chevron-down transition-transform duration-200"></i>
            </button>
            <div class="dropdown-content hidden pl-6 mt-2 space-y-1 border-l-2 border-slate-700 ml-8">
                <a href="#" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="audit-logs">
                    <i class="fas fa-list-alt w-4 h-4 mr-3"></i>
                    <span class="text-sm">Audit Logs</span>
                </a>
                <a href="account-management.html" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="account-management">
                    <i class="fas fa-user-cog w-4 h-4 mr-3"></i>
                    <span class="text-sm">My Account</span>
                </a>
                <div class="relative">
                    <a href="#" class="nav-item flex items-center px-4 py-2 text-slate-400 hover:bg-slate-800 hover:text-white rounded-lg transition-colors" data-page="notifications">
                        <i class="fas fa-bell w-4 h-4 mr-3"></i>
                        <span class="text-sm">Notifications</span>
                        <span class="ml-auto bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center">3</span>
                    </a>
                </div>
            </div>
        </div>

        </nav>
    </div>
    
    <!-- Fixed Logout Button -->
    <div class="flex-shrink-0 p-4 border-t border-slate-700">
        <button id="logout-btn" class="w-full flex items-center px-4 py-3 text-red-400 hover:bg-red-500/20 hover:text-red-300 rounded-lg transition-colors">
            <i class="fas fa-sign-out-alt w-5 h-5 mr-3"></i>
            <span>Logout</span>
        </button>
    </div>
</aside>

<!-- Logout Confirmation Modal -->
<div id="logout-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
    <div class="bg-white rounded-lg shadow-xl p-6 m-4 max-w-sm w-full transform transition-all duration-300 scale-95 opacity-0" id="logout-modal-content">
        <div class="flex items-center mb-4">
            <div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3">
                <i class="fas fa-sign-out-alt text-red-600"></i>
            </div>
            <h3 class="text-lg font-semibold text-gray-900">Confirm Logout</h3>
        </div>
        
        <p class="text-gray-600 mb-6">Are you sure you want to logout? You will be redirected to the login page.</p>
        
        <div class="flex space-x-3">
            <button id="cancel-logout" class="flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium">
                Cancel
            </button>
            <button id="confirm-logout" class="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium">
                <span id="logout-text">Logout</span>
                <i id="logout-spinner" class="fas fa-spinner fa-spin ml-2 hidden"></i>
            </button>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Dropdown functionality
    const dropdowns = document.querySelectorAll('.dropdown');
    
    dropdowns.forEach(dropdown => {
        const toggle = dropdown.querySelector('.dropdown-toggle');
        const content = dropdown.querySelector('.dropdown-content');
        const chevron = toggle.querySelector('.fa-chevron-down');
        
        toggle.addEventListener('click', (e) => {
            e.preventDefault();
            
            // Close other dropdowns
            dropdowns.forEach(otherDropdown => {
                if (otherDropdown !== dropdown) {
                    const otherContent = otherDropdown.querySelector('.dropdown-content');
                    const otherChevron = otherDropdown.querySelector('.fa-chevron-down');
                    otherContent.classList.add('hidden');
                    otherChevron.style.transform = 'rotate(0deg)';
                }
            });
            
            // Toggle current dropdown
            content.classList.toggle('hidden');
            if (content.classList.contains('hidden')) {
                chevron.style.transform = 'rotate(0deg)';
            } else {
                chevron.style.transform = 'rotate(180deg)';
            }
        });
    });

    // Highlight active page and open relevant dropdown
    const currentPage = window.location.pathname.split('/').pop() || 'admin.html';
    const navItems = document.querySelectorAll('.nav-item');
    
    navItems.forEach(item => {
        const href = item.getAttribute('href');
        const dataPage = item.getAttribute('data-page');
        
        // Check if this is the current page
        if (href === currentPage || 
            (currentPage === 'admin.html' && dataPage === 'admin') ||
            (href && href.includes(currentPage)) ||
            dataPage === currentPage.replace('.html', '')) {
            
            item.classList.add('bg-slate-800', 'text-white');
            item.classList.remove('text-slate-300', 'text-slate-400');
            
            // If this item is inside a dropdown, open the dropdown
            const parentDropdown = item.closest('.dropdown');
            if (parentDropdown) {
                const content = parentDropdown.querySelector('.dropdown-content');
                const chevron = parentDropdown.querySelector('.fa-chevron-down');
                content.classList.remove('hidden');
                chevron.style.transform = 'rotate(180deg)';
            }
        }
    });

    // Logout functionality - use local modal in this component
    const logoutBtn = document.getElementById('logout-btn');
    if (logoutBtn) {
        logoutBtn.addEventListener('click', function() {
            const modal = document.getElementById('logout-modal');
            const modalContent = document.getElementById('logout-modal-content');
            const cancelBtn = document.getElementById('cancel-logout');
            const confirmBtn = document.getElementById('confirm-logout');

            if (modal && modalContent && cancelBtn && confirmBtn) {
                modal.classList.remove('hidden');
                // small enter animation
                setTimeout(() => {
                    modalContent.classList.remove('opacity-0');
                    modalContent.classList.add('scale-100', 'opacity-100');
                }, 10);

                cancelBtn.onclick = function(e) {
                    e.preventDefault();
                    modal.classList.add('hidden');
                    modalContent.classList.add('opacity-0');
                };

                confirmBtn.onclick = function(e) {
                    e.preventDefault();
                    // Clear authentication data
                    localStorage.removeItem('authToken');
                    localStorage.removeItem('user');
                    localStorage.removeItem('isLoggedIn');
                    localStorage.removeItem('token');
                    sessionStorage.clear();

                    // Show loading state
                    confirmBtn.querySelector('#logout-text')?.classList.add('hidden');
                    const spinner = document.getElementById('logout-spinner');
                    if (spinner) spinner.classList.remove('hidden');

                    setTimeout(() => {
                        window.location.href = '/pages/login.html';
                    }, 700);
                };
            } else {
                // fallback to global helper or native confirm
                (async () => {
                    const confirmed = (typeof window.showLogoutConfirm === 'function')
                        ? await window.showLogoutConfirm()
                        : confirm('Are you sure you want to logout?');
                    if (confirmed) {
                        localStorage.removeItem('authToken');
                        localStorage.removeItem('user');
                        localStorage.removeItem('isLoggedIn');
                        localStorage.removeItem('token');
                        sessionStorage.clear();
                        window.location.href = '/pages/login.html';
                    }
                })();
            }
        });
    }
});
</script>

